<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GameState.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tests</a> &gt; <a href="index.source.html" class="el_package">io.github.uoyeng1g6.models</a> &gt; <span class="el_source">GameState.java</span></div><h1>GameState.java</h1><pre class="source lang-java linenums">package io.github.uoyeng1g6.models;

import io.github.uoyeng1g6.constants.ActivityType;
import io.github.uoyeng1g6.constants.GameConstants;
import java.util.ArrayList;
import java.util.HashMap;

/**
 * Dataclass representing the game state.
 */
<span class="fc" id="L11">public class GameState {</span>
    /**
     * Dataclass representing a single in-game day.
     */
<span class="fc" id="L15">    public static class Day {</span>
        /**
         * Map of activity type to number of activities completed of that type.
         */
<span class="fc" id="L19">        public final HashMap&lt;ActivityType, Integer&gt; activityStats = new HashMap&lt;&gt;();</span>

        /**
         * Get the number of times an activity of a specific type has been done.
         *
         * @param type the type of activity.
         * @return the number of times an activity of the given type has been done.
         */
        public int statFor(ActivityType type) {
<span class="fc" id="L28">            return activityStats.getOrDefault(type, 0);</span>
        }
    }

    /**
     * Dataclass representing an overlay to show while an interaction is occurring.
     */
    public static class InteractionOverlay {
        /**
         * The text to show on the overlay.
         */
        public final String text;
        /**
         * How long the overlay should be shown for, in seconds.
         */
        public final float displayFor;

<span class="fc" id="L45">        public InteractionOverlay(String text, float displayFor) {</span>
<span class="fc" id="L46">            this.text = text;</span>
<span class="fc" id="L47">            this.displayFor = displayFor;</span>
<span class="fc" id="L48">        }</span>
    }

    /**
     * The days that have already been completed.
     */
<span class="fc" id="L54">    public final ArrayList&lt;Day&gt; days = new ArrayList&lt;&gt;(7);</span>
    /**
     * The day that is currently in progress.
     */
<span class="fc" id="L58">    public Day currentDay = new Day();</span>

    /**
     * The number of days remaining before the game ends.
     */
<span class="fc" id="L63">    public int daysRemaining = 7;</span>
    /**
     * The amount of energy remaining to perform activities for the current day.
     */
<span class="fc" id="L67">    public int energyRemaining = GameConstants.MAX_ENERGY;</span>
    /**
     * The number of hours remaining to perform activities for the current day.
     */
<span class="fc" id="L71">    public int hoursRemaining = GameConstants.MAX_HOURS;</span>

    /**
     * The currently displayed overlay.
     */
<span class="fc" id="L76">    public InteractionOverlay interactionOverlay = null;</span>

    /**
     * End and store the current day and advance to a new one. Resets the current energy and hours remaining.
     * Shows an overlay to indicate that the player is &quot;sleeping&quot;.
     */
    public void advanceDay() {
<span class="nc" id="L83">        daysRemaining--;</span>
<span class="nc" id="L84">        energyRemaining = GameConstants.MAX_ENERGY;</span>
<span class="nc" id="L85">        hoursRemaining = GameConstants.MAX_HOURS;</span>

<span class="nc" id="L87">        days.add(currentDay);</span>
<span class="nc" id="L88">        currentDay = new Day();</span>

<span class="nc" id="L90">        interactionOverlay = new InteractionOverlay(&quot;Sleeping...&quot;, 5);</span>
<span class="nc" id="L91">    }</span>

    /**
     * Do an activity. Subtracts the amount of time and energy required to do the activity and displays
     * an overlay. If there are not enough hours left in the day, or the player does not have enough energy
     * then returns {@code false}.
     *
     * @param timeUsage the amount of time the activity requires.
     * @param energyUsage the amount of energy the activity requires.
     * @param type the type of activity being done.
     * @param overlayText the text to show on the overlay while doing the interaction.
     * @return boolean indicating whether the activity could be performed.
     */
    public boolean doActivity(int timeUsage, int energyUsage, ActivityType type, String overlayText) {
<span class="pc bpc" id="L105" title="2 of 4 branches missed.">        if (hoursRemaining &lt; timeUsage || energyRemaining &lt; energyUsage) {</span>
<span class="nc" id="L106">            return false;</span>
        }

<span class="fc" id="L109">        hoursRemaining -= timeUsage;</span>
<span class="fc" id="L110">        energyRemaining -= energyUsage;</span>
<span class="fc" id="L111">        currentDay.activityStats.merge(type, 1, Integer::sum);</span>

<span class="fc" id="L113">        interactionOverlay = new InteractionOverlay(overlayText, GameConstants.OVERLAY_SECONDS_PER_HOUR * timeUsage);</span>

<span class="fc" id="L115">        return true;</span>
    }

    /**
     * Get the total number of activities of the given type done over all days including the current.
     *
     * @param type the type of activity to get the total for.
     * @return the total number of activities of that type done.
     */
    public int getTotalActivityCount(ActivityType type) {
<span class="pc" id="L125">        return days.stream().mapToInt(day -&gt; day.statFor(type)).sum() + currentDay.statFor(type);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>